<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ztz.system.dao.FormMapper">

    <!--<resultMap id="BaseResultMap" type="com.ztz.system.pojo.Form" >-->
    <!--<id column="form_id" property="formId" jdbcType="INTEGER" />-->
    <!--<result column="form_content" property="formContent" jdbcType="VARCHAR" />-->
    <!--<result column="form_state" property="formState" jdbcType="INTEGER" />-->
    <!--<result column="form_create_time" property="formCreateTime" jdbcType="TIMESTAMP" />-->
    <!--<result column="form_company_id" property="formCompanyId" jdbcType="INTEGER" />-->
    <!--<result column="form_employee_id" property="formEmployeeId" jdbcType="INTEGER" />-->
    <!--</resultMap>-->

    <resultMap id="ExtendResultMap" type="com.ztz.system.pojo.Form">
        <id column="form_id" property="formId" jdbcType="INTEGER"/>
        <result column="form_content" property="formContent" jdbcType="VARCHAR"/>
        <result column="form_state" property="formState" jdbcType="INTEGER"/>
        <result column="form_create_time" property="formCreateTime" jdbcType="TIMESTAMP"/>
        <result column="form_company_id" property="formCompanyId" jdbcType="INTEGER"/>
        <result column="form_employee_id" property="formEmployeeId" jdbcType="INTEGER"/>
        <association property="company" javaType="com.ztz.system.pojo.Company">
            <id column="company_id" property="companyId"/>
            <result column="company_name" property="companyName"/>
        </association>
        <association property="employee" javaType="com.ztz.system.pojo.Employee">
            <id column="employee_id" property="employeeId"/>
            <result column="employee_name" property="employeeName"/>
        </association>
    </resultMap>

    <!--<sql id="Base_Column_List" >-->
    <!--form_id, form_content, form_state, form_create_time, form_company_id, form_employee_id-->
    <!--</sql>-->

    <!--// 查找单个订单-->
    <!--Form getFormById(Integer id);-->

    <!--// 查找所有订单-->
    <!--List<Form> getAllForms();-->

    <select id="getFormById" resultMap="ExtendResultMap" parameterType="java.lang.Integer">
        select *
        from form, company, employee
        where form_id = #{id, jdbcType=INTEGER} and form_company_id = company_id and form_employee_id = employee_id;
    </select>

    <select id="getAllForms" resultMap="ExtendResultMap">
        select *
        from form, company, employee
        where form_company_id = company_id and form_employee_id = employee_id and form_state != 0
        order by form_id;
    </select>

    <!--// 查找部分订单-->
    <!--List<Form> getSelectiveForms();-->

    <select id="getSelectiveForms" resultMap="ExtendResultMap" parameterType="java.lang.String">
        select *
        from form, company, employee
        where form_company_id = company_id and form_employee_id = employee_id and form_content like
        CONCAT('%',#{text, jdbcType=VARCHAR},'%');
        order by form_id;
    </select>

    <!--// 增-->
    <!--int addForm(Form form);-->
    <insert id="addForm" parameterType="com.ztz.system.pojo.Form">
        insert into form
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="formId != null">
                form_id,
            </if>
            <if test="formContent != null">
                form_content,
            </if>
            <if test="formState != null">
                form_state,
            </if>
            <if test="formCreateTime != null">
                form_create_time,
            </if>
            <if test="formCompanyId != null">
                form_company_id,
            </if>
            <if test="formEmployeeId != null">
                form_employee_id,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="formId != null">
                #{formId,jdbcType=INTEGER},
            </if>
            <if test="formContent != null">
                #{formContent,jdbcType=VARCHAR},
            </if>
            <if test="formState != null">
                #{formState,jdbcType=INTEGER},
            </if>
            <if test="formCreateTime != null">
                #{formCreateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="formCompanyId != null">
                #{formCompanyId,jdbcType=INTEGER},
            </if>
            <if test="formEmployeeId != null">
                #{formEmployeeId,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>

    <!--// 删-->
    <!--int deleteForm(Integer id);-->
    <delete id="deleteForm" parameterType="java.lang.Integer">
        delete from form
        where form_id = #{formId,jdbcType=INTEGER}
    </delete>

    <!--// 伪删-->
    <!--int deleteFormByState(Integer id);-->
    <update id="deleteFormByState" parameterType="java.lang.Integer">
        update form
        set form_state = 0
        where form_id = #{formId,jdbcType=INTEGER}
    </update>


    <!--// 改-->
    <!--int updateForm(Form form);-->
    <update id="updateForm" parameterType="com.ztz.system.pojo.Form">
        update form
        <set>
            <if test="formContent != null">
                form_content = #{formContent,jdbcType=VARCHAR},
            </if>
            <if test="formState != null">
                form_state = #{formState,jdbcType=INTEGER},
            </if>
            <if test="formCreateTime != null">
                form_create_time = #{formCreateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="formCompanyId != null">
                form_company_id = #{formCompanyId,jdbcType=INTEGER},
            </if>
            <if test="formEmployeeId != null">
                form_employee_id = #{formEmployeeId,jdbcType=INTEGER},
            </if>
        </set>
        where form_id = #{formId,jdbcType=INTEGER}
    </update>


    <!--<select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >-->
    <!--select -->
    <!--<include refid="Base_Column_List" />-->
    <!--from form-->
    <!--where form_id = #{formId,jdbcType=INTEGER}-->
    <!--</select>-->


    <!--<insert id="insert" parameterType="com.ztz.system.pojo.form" >-->
    <!--insert into form (form_id, form_content, form_state, -->
    <!--form_create_time, form_company_id, form_employee_id-->
    <!--)-->
    <!--values (#{formId,jdbcType=INTEGER}, #{formContent,jdbcType=VARCHAR}, #{formState,jdbcType=INTEGER}, -->
    <!--#{formCreateTime,jdbcType=TIMESTAMP}, #{formCompanyId,jdbcType=INTEGER}, #{formEmployeeId,jdbcType=INTEGER}-->
    <!--)-->
    <!--</insert>-->


    <!--<update id="updateByPrimaryKey" parameterType="com.ztz.system.pojo.form" >-->
    <!--update form-->
    <!--set form_content = #{formContent,jdbcType=VARCHAR},-->
    <!--form_state = #{formState,jdbcType=INTEGER},-->
    <!--form_create_time = #{formCreateTime,jdbcType=TIMESTAMP},-->
    <!--form_company_id = #{formCompanyId,jdbcType=INTEGER},-->
    <!--form_employee_id = #{formEmployeeId,jdbcType=INTEGER}-->
    <!--where form_id = #{formId,jdbcType=INTEGER}-->
    <!--</update>-->
</mapper>